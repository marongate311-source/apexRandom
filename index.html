<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Apex Legends 縛りルーレット</title>
<style>
  body { font-family:sans-serif; background:#222; color:#fff; margin:0; text-align:center; }
  .roulette { margin:20px 0; }
  .result { font-size:24px; font-weight:bold; margin-top:10px; min-height:30px; }
  img { max-width:150px; margin-top:10px; display:none; }
</style>
</head>
<body>

<h1>Apex Legends 縛りルーレット</h1>

<!-- キャラクター -->
<div class="roulette">
  <h3>キャラクター</h3>
  <label><input type="checkbox" id="charOn" checked> 有効</label>
  <label><input type="checkbox" id="charFixedCheck"> 固定化</label>
  <select id="charFixedSelect" disabled></select>
  <div class="result" id="charResult">-</div>
  <img id="charImage" src="" alt="">
  <button onclick="roll('char')">回す</button>
</div>

<!-- 武器1 -->
<div class="roulette">
  <h3>武器①</h3>
  <label><input type="checkbox" id="weapon1On" checked> 有効</label>
  <label><input type="checkbox" id="weapon1FixedCheck"> 固定化</label>
  <select id="weapon1FixedSelect" disabled></select>
  <div class="result" id="weapon1Result">-</div>
  <img id="weapon1Image" src="" alt="">
  <button onclick="roll('weapon1')">回す</button>
</div>

<!-- 武器2 -->
<div class="roulette">
  <h3>武器②</h3>
  <label><input type="checkbox" id="weapon2On" checked> 有効</label>
  <label><input type="checkbox" id="weapon2FixedCheck"> 固定化</label>
  <select id="weapon2FixedSelect" disabled></select>
  <div class="result" id="weapon2Result">-</div>
  <img id="weapon2Image" src="" alt="">
  <button onclick="roll('weapon2')">回す</button>
</div>

<script>
  // ===== クラス定義 =====
  class Character {
    constructor(name, gender, role, image) {
      this.name = name;
      this.gender = gender;
      this.role = role;
      this.image = image;
    }
  }
  class Weapon {
    constructor(name, type, ammo, isCarePackage, image) {
      this.name = name;
      this.type = type;
      this.ammo = ammo;
      this.isCarePackage = isCarePackage;
      this.image = image;
    }
  }

  // ===== データ定義 =====
  const characters = [
    new Character("レイス","女","アタッカー","images/wraith.png"),
    new Character("ジブラルタル","男","タンク","images/gibraltar.png"),
    new Character("ランパート","女","防衛","images/rampart.png"),
    new Character("バンガロール","女","アタッカー","images/bangalore.png"),
  ];

  const weapons = [
    new Weapon("R-301","AR","ライト",false,"images/r301.png"),
    new Weapon("R-99","SMG","ライト",false,"images/r99.png"),
    new Weapon("VK-47","AR","ヘビー",false,"images/vk47.png"),
    new Weapon("プラウラー","SMG","ヘビー",false,"images/plrowler.png"),
    new Weapon("クレーバー","SR","特殊",true,"images/kraber.png"),
  ];

  // ===== プルダウン初期化 =====
  function initSelect(selectId, dataList) {
    const select = document.getElementById(selectId);
    dataList.forEach(d => {
      const option = document.createElement("option");
      option.value = d.name;
      option.textContent = d.name;
      select.appendChild(option);
    });
  }

  // ページロード時
  window.onload = () => {
    initSelect("charFixedSelect", characters);
    initSelect("weapon1FixedSelect", weapons);
    initSelect("weapon2FixedSelect", weapons);

    // チェックONで有効化
    ["char","weapon1","weapon2"].forEach(type => {
      document.getElementById(type + "FixedCheck").addEventListener("change", (e) => {
        document.getElementById(type + "FixedSelect").disabled = !e.target.checked;
      });
    });
  };

  // ===== ルーレット処理 =====
  function roll(type) {
    const on = document.getElementById(type + "On").checked;
    if (!on) return;

    const fixedCheck = document.getElementById(type + "FixedCheck").checked;
    const fixedSelect = document.getElementById(type + "FixedSelect");
    let choice;

    if (type === "char") {
      if (fixedCheck) {
        choice = characters.find(c => c.name === fixedSelect.value);
      } else {
        choice = characters[Math.floor(Math.random() * characters.length)];
      }
    } else { // weapon1, weapon2
      if (fixedCheck) {
        choice = weapons.find(w => w.name === fixedSelect.value);
      } else {
        choice = weapons[Math.floor(Math.random() * weapons.length)];
      }
    }

    // 結果表示
    document.getElementById(type + "Result").innerText = choice.name;
    const imgEl = document.getElementById(type + "Image");
    imgEl.src = choice.image;
    imgEl.style.display = "block";
  }
</script>

</body>
</html>
